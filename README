initcpio hooks to allow you to use a yubikey in challenge-response HMAC
mode to do 2-factor authentication for LUKS.

password you type in -> yubikey hmacs it with its secret key -> yubikey
returns the password for LUKS

This has the property that someone with access to your yubikey cannot
trivially gain useful information (this is not the case if you config
it to output a static passphrase which you concatenate to a password
you type in)

Naturally, if someone knows your password and later has access to your
yubikey, they can can get the LUKS password.

INSTALL

You need to put "yubiluks" *before* "encrypt" in the HOOKS line in your
/etc/mkinitcpio.conf file in order for the yubikey things to happen
before cryptsetup is invoked.

To set up the yubikey, you do:
ykpersonalize -v -1 -ochal-resp -ochal-hmac -ohmac-lt64 -ochal-btn-trig -oserial-api-visible

The -ochal-btn-trig option makes it such that instead of immediately
returning data in response to a challenge, it makes the yubikey's LED
blink and only returns data when you touch the yubikey's button.

Put the stuff in hooks/ into /etc/initcpio/hooks/ and the stuff in
install/ into /etc/initcpio/install/ and edit your /etc/mkinitcpio.conf
appropriately.

To add the appropriate keyslot in the LUKS volume, do:
read -s PW
ykchalresp "$PW" | tr -d '\n' > mykeyfile
cryptsetup luksAddKey /dev/whatever mykeyfile
rm mykeyfile

